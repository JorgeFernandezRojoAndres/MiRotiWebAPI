{
  "Views": {
    "Pedidos": {
      "Edit.cshtml": "@model MiRoti.Models.Pedido\r\n\r\n@{\r\n    ViewData[\"Title\"] = \"Editar Pedido\";\r\n    var clientes = ViewData[\"Clientes\"] as List<MiRoti.Models.Cliente>;\r\n    var cadetes = ViewData[\"Cadetes\"] as List<MiRoti.Models.Cadete>;\r\n}\r\n\r\n<div class=\"container mt-4\">\r\n    <h2 class=\"fw-bold mb-4\"><i class=\"bi bi-pencil-square me-2\"></i>Editar Pedido #@Model.Id</h2>\r\n\r\n    <form asp-action=\"Edit\" method=\"post\">\r\n        <input type=\"hidden\" asp-for=\"Id\" />\r\n\r\n        <!-- Selecci√≥n de Cliente -->\r\n        <div class=\"col-md-6\">\r\n            <label asp-for=\"ClienteId\" class=\"form-label fw-semibold\">Cliente</label>\r\n            <select asp-for=\"ClienteId\" class=\"form-select\">\r\n                @foreach (var c in clientes!)\r\n                {\r\n                    <option value=\"@c.Id\" selected=\"@((Model.ClienteId == c.Id) ? \"selected\" : \"\")\">\r\n                        @c.Nombre\r\n                    </option>\r\n                }\r\n            </select>\r\n        </div>\r\n\r\n        <!-- Selecci√≥n de Cadete -->\r\n        <div class=\"col-md-6\">\r\n            <label asp-for=\"CadeteId\" class=\"form-label fw-semibold\">Cadete</label>\r\n            <select asp-for=\"CadeteId\" class=\"form-select\">\r\n                <option value=\"\">-- Sin asignar --</option>\r\n                @foreach (var cad in cadetes!)\r\n                {\r\n                    <option value=\"@cad.Id\" selected=\"@((Model.CadeteId == cad.Id) ? \"selected\" : \"\")\">\r\n                        @cad.Nombre\r\n                    </option>\r\n                }\r\n            </select>\r\n        </div>\r\n\r\n        <!-- Selecci√≥n de Estado -->\r\n        <div class=\"mb-3\">\r\n            <label asp-for=\"Estado\" class=\"form-label fw-semibold\">Estado</label>\r\n            <select asp-for=\"Estado\" class=\"form-select\">\r\n                @if (Model.Estado == \"Pendiente\")\r\n                {\r\n                    <option value=\"Pendiente\" selected>Pendiente</option>\r\n                }\r\n                else\r\n                {\r\n                    <option value=\"Pendiente\">Pendiente</option>\r\n                }\r\n\r\n                @if (Model.Estado == \"En Preparaci√≥n\")\r\n                {\r\n                    <option value=\"En Preparaci√≥n\" selected>En Preparaci√≥n</option>\r\n                }\r\n                else\r\n                {\r\n                    <option value=\"En Preparaci√≥n\">En Preparaci√≥n</option>\r\n                }\r\n\r\n                @if (Model.Estado == \"En Camino\")\r\n                {\r\n                    <option value=\"En Camino\" selected>En Camino</option>\r\n                }\r\n                else\r\n                {\r\n                    <option value=\"En Camino\">En Camino</option>\r\n                }\r\n\r\n                @if (Model.Estado == \"Completado\")\r\n                {\r\n                    <option value=\"Completado\" selected>Completado</option>\r\n                }\r\n                else\r\n                {\r\n                    <option value=\"Completado\">Completado</option>\r\n                }\r\n            </select>\r\n        </div>\r\n\r\n        <!-- Detalles del Pedido -->\r\n        <div class=\"card shadow-sm border-0 mt-4\">\r\n            <div class=\"card-header bg-light fw-semibold\">\r\n                Detalles del Pedido\r\n            </div>\r\n            <div class=\"card-body\">\r\n                @if (Model.Detalles != null && Model.Detalles.Any())\r\n                {\r\n                    <table class=\"table table-sm align-middle\">\r\n                        <thead class=\"table-light\">\r\n                            <tr>\r\n                                <th>Plato</th>\r\n                                <th>Cantidad</th>\r\n                                <th>Precio Unitario</th>\r\n                                <th>Subtotal</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            @foreach (var d in Model.Detalles)\r\n                            {\r\n                                <tr>\r\n                                    <td>@d.Plato?.Nombre</td>\r\n                                    <td>@d.Cantidad</td>\r\n                                    <td>@d.Plato?.PrecioVenta.ToString(\"C\")</td>\r\n                                    <td>@d.Subtotal.ToString(\"C\")</td>\r\n                                </tr>\r\n                            }\r\n                        </tbody>\r\n                    </table>\r\n                    <div class=\"text-end fw-bold me-3\">\r\n                        Total: @Model.Total.ToString(\"C\")\r\n                    </div>\r\n                }\r\n                else\r\n                {\r\n                    <p class=\"text-muted fst-italic\">No hay detalles registrados.</p>\r\n                }\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Errores de validaci√≥n -->\r\n        <div asp-validation-summary=\"ModelOnly\" class=\"alert alert-danger mt-3\"></div>\r\n\r\n        <!-- Botones de acci√≥n -->\r\n        <div class=\"mt-4 d-flex justify-content-between\">\r\n            <a asp-action=\"Index\" class=\"btn btn-outline-secondary\">\r\n                <i class=\"bi bi-arrow-left\"></i> Volver\r\n            </a>\r\n            <button type=\"submit\" class=\"btn btn-primary px-4\">\r\n                <i class=\"bi bi-save\"></i> Guardar Cambios\r\n            </button>\r\n        </div>\r\n    </form>\r\n</div>\r\n",
      "EditarEstado.cshtml": "@model MiRoti.Models.Pedido \r\n\r\n@{\r\n    ViewData[\"Title\"] = \"Editar Estado del Pedido\";\r\n}\r\n\r\n<h2>@ViewData[\"Title\"] #@Model.Id</h2>\r\n\r\n<form method=\"post\">\r\n    <div class=\"form-group\">\r\n        <label for=\"Estado\">Estado del Pedido</label>\r\n        <!-- Usando asp-for para manejar la selecci√≥n del estado -->\r\n        <select asp-for=\"Estado\" class=\"form-select\">\r\n            <option value=\"Pendiente\">Pendiente</option>\r\n            <option value=\"En Preparaci√≥n\">En Preparaci√≥n</option>\r\n            <option value=\"En Camino\">En Camino</option>\r\n            <option value=\"Completado\">Completado</option>\r\n        </select>\r\n    </div>\r\n\r\n    <button type=\"submit\" class=\"btn btn-primary\">Actualizar Estado</button>\r\n</form>\r\n\r\n<a href=\"@Url.Action(\"Index\", \"Pedidos\")\">Volver</a>\r\n",
      "Index.cshtml": "@model IEnumerable<MiRoti.Models.Pedido>\r\n\r\n@{\r\n    Context.Session.SetString(\"UsuarioRol\", \"Cocinero\");\r\n\r\n    Layout = \"~/Views/Shared/_Layout.cshtml\";\r\n    ViewData[\"Title\"] = \"Gesti√≥n de Pedidos\";\r\n\r\n    var rol = Context.Session.GetString(\"UsuarioRol\") ?? \"Invitado\";\r\n\r\n    // üìä M√©tricas recibidas desde el controlador\r\n    var totalPedidos = (int?)ViewData[\"TotalPedidos\"] ?? 0;\r\n    var entregados = (int?)ViewData[\"Entregados\"] ?? 0;\r\n    var enCamino = (int?)ViewData[\"EnCamino\"] ?? 0;\r\n    var nuevos = (int?)ViewData[\"Nuevos\"] ?? 0;\r\n    var totalGanancia = (decimal?)ViewData[\"TotalGanancia\"] ?? 0;\r\n}\r\n\r\n<div class=\"container-fluid px-4 mt-4\">\r\n    <!-- üîπ Encabezado -->\r\n    <div class=\"d-flex justify-content-between align-items-center mb-4 border-bottom pb-2\">\r\n        <h2 class=\"fw-bold text-dark\">\r\n            <i class=\"bi bi-receipt-cutoff me-2 text-warning\"></i> Gesti√≥n de Pedidos\r\n        </h2>\r\n    </div>\r\n    <p class=\"text-muted\">Visualiz√°, control√° y gestion√° los pedidos activos y entregados.</p>\r\n\r\n    <!-- üîπ Mensaje de √©xito -->\r\n    @if (TempData[\"SuccessMessage\"] != null)\r\n    {\r\n        <div class=\"alert alert-success\">\r\n            @TempData[\"SuccessMessage\"]\r\n        </div>\r\n    }\r\n\r\n    <!-- üîπ Tarjetas de m√©tricas -->\r\n    <div class=\"row mb-4 g-3\">\r\n        <div class=\"col-md-3\">\r\n            <div class=\"card border-0 shadow-sm p-3\">\r\n                <div class=\"d-flex justify-content-between align-items-center\">\r\n                    <div>\r\n                        <p class=\"mb-1 fw-semibold text-secondary\">Pedidos Totales</p>\r\n                        <h4 class=\"fw-bold\">@totalPedidos</h4>\r\n                    </div>\r\n                    <i class=\"bi bi-list-check fs-3 text-warning\"></i>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"col-md-3\">\r\n            <div class=\"card border-0 shadow-sm p-3\">\r\n                <div class=\"d-flex justify-content-between align-items-center\">\r\n                    <div>\r\n                        <p class=\"mb-1 fw-semibold text-secondary\">Entregados</p>\r\n                        <h4 class=\"fw-bold\">@entregados</h4>\r\n                    </div>\r\n                    <i class=\"bi bi-check2-circle fs-3 text-success\"></i>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"col-md-3\">\r\n            <div class=\"card border-0 shadow-sm p-3\">\r\n                <div class=\"d-flex justify-content-between align-items-center\">\r\n                    <div>\r\n                        <p class=\"mb-1 fw-semibold text-secondary\">En Camino</p>\r\n                        <h4 class=\"fw-bold\">@enCamino</h4>\r\n                    </div>\r\n                    <i class=\"bi bi-truck fs-3 text-primary\"></i>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"col-md-3\">\r\n            <div class=\"card border-0 shadow-sm p-3\">\r\n                <div class=\"d-flex justify-content-between align-items-center\">\r\n                    <div>\r\n                        <p class=\"mb-1 fw-semibold text-secondary\">Ganancia Total</p>\r\n                        <h4 class=\"fw-bold\">@totalGanancia.ToString(\"C0\")</h4>\r\n                    </div>\r\n                    <i class=\"bi bi-cash-coin fs-3 text-warning\"></i>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- üîπ Tabla de pedidos -->\r\n    <div class=\"card border-0 shadow-sm\">\r\n        <div class=\"card-body\">\r\n            @if (!Model.Any())\r\n            {\r\n                <div class=\"text-center p-5 text-muted\">\r\n                    <i class=\"bi bi-box fs-1 mb-3\"></i>\r\n                    <h5>No hay pedidos registrados a√∫n</h5>\r\n                    <p>Los pedidos aparecer√°n aqu√≠ una vez que sean creados por los clientes.</p>\r\n                </div>\r\n            }\r\n            else\r\n            {\r\n                <div class=\"table-responsive\">\r\n                    <table class=\"table table-hover align-middle\">\r\n                        <thead class=\"table-light\">\r\n                            <tr>\r\n                                <th>Cliente</th>\r\n                                <th>Fecha</th>\r\n                                <th>Total</th>\r\n                                <th>Estado</th>\r\n                                <th>Cadete</th>\r\n                                <th>Acciones</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            @foreach (var p in Model)\r\n                            {\r\n                                <script>\r\n                                    // Verifica el estado de cada pedido en la consola\r\n                                    console.log(\"Estado del pedido:\", \"@p.Estado\", \"Pedido ID:\", @p.Id);\r\n                                </script>\r\n                                <tr>\r\n                                    <td>@p.Cliente?.Nombre</td>\r\n                                    <td>@p.FechaHora.ToString(\"dd/MM/yyyy HH:mm\")</td>\r\n                                    <td>@p.Total.ToString(\"C0\")</td>\r\n                                    <td>\r\n                                        <span class=\"badge \r\n                            @(p.Estado == \"Entregado\" ? \"bg-success\" :\r\n                                                                  p.Estado == \"En camino\" ? \"bg-primary\" :\r\n                                                                  p.Estado == \"Preparando\" ? \"bg-warning text-dark\" :\r\n                                                                  p.Estado == \"Pendiente\" ? \"bg-secondary\" :\r\n                                                                  \"bg-info\")\">\r\n                                            @p.Estado\r\n                                        </span>\r\n                                    </td>\r\n\r\n                                    <td>@p.Cadete?.Nombre</td>\r\n                                    <td>\r\n                                        <a asp-action=\"Details\" asp-route-id=\"@p.Id\"\r\n                                            class=\"btn btn-sm btn-outline-secondary me-1\">\r\n                                            <i class=\"bi bi-eye\"></i>\r\n                                        </a>\r\n                                        @if (p.Estado != \"Entregado\")\r\n                                        {\r\n                                            <a asp-action=\"EditarEstado\" asp-route-id=\"@p.Id\"\r\n                                                class=\"btn btn-sm btn-outline-primary me-1\">\r\n                                                <i class=\"bi bi-pencil\"></i>\r\n                                            </a>\r\n                                        }\r\n                                    </td>\r\n                                </tr>\r\n                            }\r\n                        </tbody>\r\n\r\n                    </table>\r\n                </div>\r\n            }\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n@section Scripts {\r\n    <script>\r\n        console.log(\"üß© Layout cargado:\", \"@Layout\");\r\n        console.log(\"üß© Bootstrap CSS:\", document.querySelector('link[href*=\\\"bootstrap\\\"]')?.href);\r\n        console.log(\"üß© Bootstrap JS:\", typeof bootstrap !== \"undefined\" ? \"OK ‚úÖ\" : \"NO ‚ùå\");\r\n        console.log(\"üß© Iconos:\", document.querySelector('link[href*=\\\"bootstrap-icons\\\"]')?.href);\r\n        console.log(\"üß© Navbar existe:\", document.querySelector('.navbar') ? \"‚úÖ S√≠\" : \"‚ùå No\");\r\n\r\n        window.addEventListener(\"load\", () => {\r\n            console.log(\"‚úÖ DOM completamente cargado (Pedidos)\");\r\n            const navbar = document.querySelector('.navbar');\r\n            if (!navbar) console.warn(\"‚ö†Ô∏è El layout no se est√° aplicando o el navbar no existe.\");\r\n        });\r\n    </script>\r\n}"
    }
  }
}